/*
 * @package   local_restrict
 * @copyright 2025 Moayad Shloul <shloul97@gmail.com>
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later.
 */
define("local_restrict/action",["jquery","core/ajax","core/str"],(function($,Ajax,str){return{init:function(){var mkadminconfirm,adminremovecofnirm,delconfirm,failedalert,mkadmin,rmadmin,active,activate,inactive,suspend,ajxerr="",jserr="",args="";str.get_strings([{key:"ajxerr",component:"local_restrict"},{key:"jserr",component:"local_restrict"},{key:"args",component:"local_restrict"},{key:"mkadminconfirm",component:"local_restrict"},{key:"adminremovecofnirm",component:"local_restrict"},{key:"delconfirm",component:"local_restrict"},{key:"failedalert",component:"local_restrict"}]).then((function(results){ajxerr=results[0],jserr=results[1],args=results[2],mkadminconfirm=results[3],adminremovecofnirm=results[4],delconfirm=results[5],failedalert=results[6]})).catch((function(e){alert(failedalert,e)}));const stringKeys=["rmadmin","mkadmin","suspend","activate","active","inactive"],strings=stringKeys.map((key=>({key:key,component:"local_restrict"})));str.get_strings(strings).then((results=>{const localized=Object.fromEntries(stringKeys.map(((key,i)=>[key,results[i]])));rmadmin=localized.rmadmin,mkadmin=localized.mkadmin,activate=localized.activate,inactive=localized.inactive,suspend=localized.suspend,active=localized.active})).catch((e=>{alert(failedalert,e)})),$("button[name=action-btn]").click((function(){var deviceId=$(this).attr("data-id"),action=$(this).attr("data-action"),btn=$(this),spanText=$("#span-"+deviceId),dataAction="sus";if("sus"==action&&(dataAction="act"),"del"===action){if(1==confirm(delconfirm)){var requestArgs={deviceid:parseInt(deviceId),action:action.toString()};Ajax.call([{methodname:"local_restrict_update_labs",args:requestArgs}])[0].then((function(){$("#tr-"+deviceId).fadeOut(300)})).catch((function(err){let error="<span>".concat(ajxerr," ").concat(err," <span><br><span>\n                                        ").concat(jserr," ").concat(err.message,"</span><br><span>\n                                        ").concat(args," ").concat(requestArgs,"</span>");$("#ajx-err").html(error)}))}}else{requestArgs={deviceid:parseInt(deviceId),action:action.toString()};Ajax.call([{methodname:"local_restrict_update_labs",args:requestArgs}])[0].then((function(){"del"!=action&&(btn.attr("data-action",dataAction),btn.toggleClass("btn-warning btn-success"),btn.html()===suspend?(btn.html(activate),spanText.html(inactive)):(btn.html(suspend),spanText.html(active)),spanText.toggleClass("text-success text-danger"))})).catch((function(err){let error="<span>".concat(ajxerr," ").concat(err," <span><br><span>\n                                    ").concat(jserr," ").concat(err.message,"</span><br><span>\n                                    ").concat(args," ").concat(requestArgs,"</span>");$("#ajx-err").html(error)}))}})),$("button[name=admin-btn]").click((function(){var dataAction=$(this).attr("data-action"),btn=$(this),deviceId=$(this).attr("data-id"),lab=btn.attr("data-lab"),confirmString="";if(confirmString="mkadmin"==dataAction?mkadminconfirm:adminremovecofnirm,1==confirm(confirmString)){var requestArgs={deviceid:parseInt(deviceId,10),action:"admin".toString(),dataaction:dataAction.toString(),lab:parseInt(lab,10)};Ajax.call([{methodname:"local_restrict_update_labs",args:requestArgs}])[0].then((function(e){1==e.status&&(btn.toggleClass("btn-primary btn-secondary"),"mkadmin"===dataAction?(dataAction="rmadmin",btn.html(rmadmin),btn.attr("data-action","rmadmin")):"rmadmin"===dataAction&&(btn.html(mkadmin),btn.attr("data-action","mkadmin")))})).catch((function(err){let error="<span>".concat(ajxerr," ").concat(err," <span><br><span>\n                                    ").concat(jserr," ").concat(err.message,"</span><br><span>\n                                    ").concat(args," ").concat(requestArgs,"</span>");$("#ajx-err").html(error)}))}}))}}}));

//# sourceMappingURL=action.min.js.map